<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NiNi — Admin Login</title>
  <link rel="icon" href="/public/assets/icons/logonini.svg" type="image/svg+xml" />
  <link rel="stylesheet" href="/public/theme/nini-base.css" />
</head>
<body style="--bg-url:url('/public/assets/bg/nini_home.webp')">
  <header class="site-header">
    <a class="brand" href="/#home" aria-label="NiNi — Funny">
      <img class="brand__logo" src="/public/assets/icons/logo_text.webp" alt="NiNi Funny" />
      <div class="brand__slogan">Chơi mê ly, bứt phá tư duy</div>
    </a>
    <div class="spacer"></div>
    <a class="btn" href="/">↩ Trang chủ</a>
  </header>

  <main class="page-hero">
    <section class="panel">
      <h2>Admin — Đăng nhập</h2>
      <div class="row">
        <input id="email" class="input underline" type="email" placeholder="admin@example.com" autocomplete="email" />
        <input id="password" class="input underline" type="password" placeholder="Mật khẩu" autocomplete="current-password" />
        <button id="btnLogin" class="btn">Đăng nhập</button>
      </div>
      <p id="note" class="note"></p>
    </section>
  </main>

  <script>
    const $ = s => document.querySelector(s);
    const note = $("#note");
    $("#btnLogin").addEventListener("click", async () => {
      const email = $("#email").value.trim();
      const password = $("#password").value;
      if (!email || !password) { note.textContent="Nhập email & mật khẩu."; note.className="note bad"; return; }
      note.textContent = "Đang đăng nhập…"; note.className = "note";
      try{
        const r = await fetch("/.netlify/functions/admin-auth/login", {
          method: "POST",
          credentials: "include",
          headers: { "content-type": "application/json" },
          body: JSON.stringify({ email, password })
        });
        const j = await r.json().catch(()=>({}));
        if (!r.ok || !j.ok) throw new Error(j.error || "Sai thông tin");
        location.replace("/admin/index.html");
      }catch(e){
        note.textContent = "Không thể đăng nhập: " + (e.message || e);
        note.className = "note bad";
      }
    });
  </script>
</body>
</html>
