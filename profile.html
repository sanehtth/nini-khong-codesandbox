<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NiNi — Profile</title>

  <!-- Favicon: tránh 404 -->
  <link rel="icon" href="/public/assets/icons/logonini.webp" type="image/webp" />

  <!-- CSS nền + theme -->
  <link rel="stylesheet" href="/public/theme/nini-base.css" />

  <!-- (tuỳ chọn) override theme từ Netlify function -->
  <script defer src="/public/js/theme-boot.js"></script>
</head>
<body>
  <main class="page-hero">
    <!-- KHÔNG render #frame cho trang profile -->
    <section class="panel-glass wrap-page" aria-label="Hồ sơ cá nhân">
      <div class="grid grid-2">
        <div>
          <img id="avatarImg" class="avatar" src="/public/assets/avatar/NV1.webp" alt="avatar" />
          <div class="row">
            <button id="btnUpload" class="btn small">Tải ảnh mới</button>
            <button id="btnDefault" class="btn small">Về mặc định</button>
          </div>
        </div>

        <div>
          <label>Email <input id="email" class="input" readonly></label>
          <label>Tên hiển thị <input id="displayName" class="input" placeholder="Bé NiNi"></label>
          <label>Ngày sinh <input id="dob" class="input" type="date"></label>
          <label>Tỉnh/Thành <input id="city" class="input" placeholder="Hà Nội / TPHCM ..."></label>
          <label>Lớp/Khối <input id="grade" class="input" placeholder="Lớp 2, Lớp 3..."></label>
          <label>Tên phụ huynh (tuỳ chọn) <input id="parentName" class="input"></label>
          <label>Số điện thoại <input id="phone" class="input" placeholder="09xxxxxxxx"></label>

          <div class="row">
            <button id="btnSave" class="btn">Lưu hồ sơ</button>
            <button id="btnSetPass" class="btn gray">Đổi / Thêm mật khẩu</button>
          </div>
        </div>
      </div>

      <aside class="panel" style="margin-top:16px">
        <h2>Thành tích</h2>
        <div class="row"><span>XP:</span><span id="statXp">0</span></div>
        <div class="row"><span>Xu:</span><span id="statCoin">0</span></div>
        <button id="btnSync" class="btn small">Đồng bộ lại</button>
      </aside>
    </section>

    <!-- Footer chips đồng bộ toàn site -->
    <footer class="footer-nav">
      <button class="chip" data-section="intro">Giới thiệu</button>
      <button class="chip" data-section="rules">Luật chơi</button>
      <button class="chip" data-section="forum">Diễn đàn</button>
      <button class="chip" data-section="feedback">Góp ý</button>
    </footer>
  </main>

  <!-- Modal Auth: dùng modal chung của site (đã có JS điều khiển) -->
  <div id="authModal" aria-hidden="true">
    <!-- ... markup modal như ở trang chủ (giữ nguyên) ... -->
  </div>

  <!-- JS: utils/header + auth modal + app (mùa, footer chips, modal hooks) -->
  <script src="/public/js/nini-utils.js" defer></script>
  <script src="/public/js/nini-header.js" defer></script>

  <!-- KHÔNG dùng login page; dùng auth modal (ui-auth-js) -->
  <script src="/public/js/ui-auth.js" defer></script> <!-- modal login/register: mở/đóng + gọi Netlify Functions -->
  <script src="/public/js/app.js" defer></script>     <!-- season tabs, footer chips, modal open/close, v.v. -->

  <script>
    // Guard: nếu chưa login thì mở modal, không redirect
    (function(){
      const isLoggedIn = localStorage.getItem('NINI_AUTH_LOGGED_IN') === '1';
      if (!isLoggedIn) {
        // Cho phép xem layout trước khi login, nhưng nếu bạn muốn bắt buộc thì:
        document.getElementById('authBtn')?.click(); // mở modal
        // return; // bật nếu bạn muốn chặn mọi thao tác tới khi đăng nhập
      }
    })();
  </script>
</body>
</html>


