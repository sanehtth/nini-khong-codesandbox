<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NiNi — Quên mật khẩu</title>
  <link rel="icon" href="/public/assets/icons/logonini.svg" type="image/svg+xml" />
  <link rel="stylesheet" href="/public/theme/nini-base.css" />
</head>
<body style="--bg-url:url('/public/assets/bg/nini_home.webp')">
  <header class="site-header">
    <a class="brand" href="/#home" aria-label="NiNi — Funny">
      <img class="brand__logo" src="/public/assets/icons/logo_text.webp" alt="NiNi Funny" />
      <div class="brand__slogan">Chơi mê ly, bứt phá tư duy</div>
    </a>
    <div class="spacer"></div>
    <a class="btn" href="/">↩ Trang chủ</a>
  </header>

  <main class="page-hero">
    <section class="panel">
      <h2>Quên mật khẩu</h2>
      <p class="muted">Nhập email của bạn để nhận liên kết đặt lại mật khẩu.</p>
      <div class="row">
        <input id="email" class="input underline" type="email" placeholder="you@example.com" autocomplete="email" />
        <button id="btnSend" class="btn">Gửi liên kết</button>
      </div>
      <p id="note" class="note"></p>
    </section>
  </main>

  <script>
    const $ = s => document.querySelector(s);
    const email = $("#email");
    const note  = $("#note");
    $("#btnSend").addEventListener("click", async () => {
      const v = (email.value || "").trim();
      if (!v) { note.textContent = "Vui lòng nhập email."; note.className = "note bad"; return; }
      note.textContent = "Đang gửi…"; note.className = "note";
      try {
        const r = await fetch("/.netlify/functions/send-reset", {
          method: "POST",
          headers: { "content-type": "application/json" },
          body: JSON.stringify({ email: v })
        });
        const j = await r.json().catch(()=>({}));
        if (!r.ok) throw new Error(j.error || "Gửi không thành công");
        note.textContent = "Đã gửi! Vui lòng kiểm tra hộp thư của bạn.";
        note.className = "note ok";
      } catch (e) {
        note.textContent = "Không thể gửi email: " + (e.message || e);
        note.className = "note bad";
      }
    });
  </script>
</body>
</html>
