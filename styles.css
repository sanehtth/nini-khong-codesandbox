/* =======================
   NiNi — ONE STYLE (FULL)
   ======================= */

:root{
  --glass: rgba(255,255,255,.15);
  --glass-strong: rgba(255,255,255,.25);
  --border: rgba(255,255,255,.6);
  --text: #1c2024;
  --green: #2f6e3f;       /* xanh lá chủ đạo */
  --green-2: #3b8a5a;     /* xanh lá đậm (active) */
  --green-soft: rgba(47,110,63,.40);  /* bóng đổ */
  --note-ok:#0f5132;
  --note-err:#7f1d1d;
  --radius: 16px;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  color:var(--text);
  font: 16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial;
  background: #e6f1e9 var(--bg-url) center/cover fixed no-repeat;
}

/* ---------- Header ---------- */
.site-header{
  display:flex; align-items:center; gap:16px;
  padding:10px 14px;
  position:sticky; top:0; z-index:10;
  backdrop-filter: blur(8px);
}
.brand{display:flex; align-items:center; gap:10px; text-decoration:none}
.brand__logo{height:34px; width:auto; display:block}
.brand__slogan{
  font-weight:700; letter-spacing:.2px; user-select:none;
  /* text gradient animate: vàng → xanh → nâu */
  background: linear-gradient(90deg,#f3d56b 0%, #2f6e3f 50%, #7a5b3a 100%);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  animation: sloganHue 6s linear infinite;
}
@keyframes sloganHue{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

/* ---------- Tabs (seasons) ---------- */
.tabs{margin-left:auto; display:flex; gap:8px; flex-wrap:wrap}
.tab{
  appearance:none; border:1px solid var(--border);
  background: var(--glass);
  color:#fff; font-weight:700; padding:6px 12px; border-radius:999px;
  cursor:pointer; backdrop-filter: blur(6px);
  box-shadow: 0 6px 18px rgba(0,0,0,.10);
  transition: box-shadow .2s ease, border-color .2s, background .2s;
}
.tab:hover{background:var(--glass-strong)}
.tab.is-active{
  border-color: var(--green-2);
  box-shadow: 0 10px 24px var(--green-soft), 0 0 0 1px var(--green-2) inset;
  background: rgba(255,255,255,.30);
}

/* ---------- Auth buttons ---------- */
.auth-btn{
  margin-left:10px;
  border:1px solid var(--border); background:var(--glass);
  color:#fff; font-weight:700; border-radius:999px; padding:6px 12px;
  cursor:pointer; backdrop-filter: blur(6px);
}
.auth-btn:hover{background:var(--glass-strong)}

/* ---------- Admin link (ẩn/hiện bằng hotkey) ---------- */
.admin-link{
  margin-left:10px; text-decoration:none; color:#fff;
  border:1px solid var(--border); background:var(--glass);
  padding:6px 12px; border-radius:999px; backdrop-filter: blur(6px);
}
.admin-link.is-hidden{display:none}

/* ---------- Viewport + Frame ---------- */
.viewport{padding:8px 14px 40px}
.frame{
  position:relative;
  width:min(100%, 1100px);
  margin-inline:auto;
  aspect-ratio: 16/9;
  border-radius: 18px;
  background: var(--glass);
  backdrop-filter: blur(10px);
  overflow:hidden;
  box-shadow: 0 16px 40px rgba(0,0,0,.18);
  background-image: var(--bg-url);
  background-size: cover; background-position: center;
}
.nini{position:absolute; inset:auto auto 18% 50%; transform:translateX(-50%); height:140px; z-index:3}
.chips{
  position:absolute; inset:auto auto 12% 50%; transform:translateX(-50%);
  display:flex; gap:10px; z-index:3;
}
.chip{
  border:1px solid var(--border); background:var(--glass); color:#fff;
  padding:6px 12px; border-radius:999px; font-weight:700; cursor:pointer;
  backdrop-filter: blur(6px); transition: .2s;
}
.chip:hover{background:var(--glass-strong)}
.chip.is-active{
  border-color: var(--green-2);
  box-shadow: 0 10px 24px var(--green-soft), 0 0 0 1px var(--green-2) inset;
  background: rgba(255,255,255,.30);
}

/* FX canvas layer */
.fx-layer{position:absolute; inset:0; pointer-events:none; z-index:2}

/* ---------- Content card dưới frame ---------- */
.content{
  width:min(100%, 1100px); margin:18px auto 0;
  background:var(--glass); backdrop-filter: blur(10px);
  border-radius: var(--radius); padding:16px 18px; color:#fff;
  box-shadow: 0 12px 28px rgba(0,0,0,.12);
}

/* ---------- Modal (glass panel) ---------- */
.modal{position:fixed; inset:0; z-index:20; display:block}
.modal[aria-hidden="true"]{display:none}
.modal__backdrop{position:absolute; inset:0; background:rgba(0,0,0,.35); backdrop-filter: blur(2px)}
.modal__panel{
  position:absolute; inset:50% auto auto 50%;
  transform:translate(-50%,-50%);
  width:min(560px, 92vw);
  background: rgba(255,255,255,.85);
  border-radius: 16px;
  padding: 24px 20px 18px;
  box-shadow: 0 20px 50px rgba(0,0,0,.25);
}
.modal__close{
  position:absolute; right:10px; top:10px; border:0; background:transparent; font-size:20px; cursor:pointer
}
.modal__title{
  display:flex; align-items:center; gap:10px; margin:0 0 10px;
  color:var(--green);
}
.modal__logo{height:26px}

/* ---------- Form (underline inputs) ---------- */
.form{display:block}
.form label{display:block; font-weight:700; margin:10px 0 6px; color:#2a3b33}
.form .input, .form input[type="text"], .form input[type="email"], .form input[type="password"]{
  width:100%; background:transparent; border:0; outline:none;
  border-bottom:2px solid rgba(255,255,255,.65); color:#1c2024; padding:8px 4px;
}
.form .input::placeholder, .form input::placeholder{color:#8aa69a}
.form .input:focus, .form input:focus{
  border-bottom-color: var(--green-2);
  box-shadow: 0 6px 0 -4px var(--green-2);
}
.row{display:flex; gap:10px; align-items:center}

/* ---------- Buttons (glass) ---------- */
.btn{
  border:1px solid var(--border); background:var(--glass); color:#fff;
  padding:8px 14px; font-weight:800; border-radius:12px; cursor:pointer;
  backdrop-filter: blur(6px); transition:.2s;
  box-shadow: 0 6px 18px rgba(0,0,0,.10);
}
.btn:hover{background:var(--glass-strong)}
.btn.full{width:100%}
.btn.is-active{
  border-color: var(--green-2);
  background: rgba(255,255,255,.30);
  box-shadow: 0 12px 28px var(--green-soft), 0 0 0 1px var(--green-2) inset;
}

/* ---------- Notes ---------- */
.note{margin-top:8px; font-size:14px; color:#2f3e39}
.note.ok{color:var(--note-ok)} .note.err{color:var(--note-err)}

/* ---------- Shelf (books) ---------- */
.shelf{padding:14px}
.shelf__title{margin:0 0 8px; color:#fff}
.shelf__grid{display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:12px}
.book-card{background:rgba(255,255,255,.85); border-radius:12px; overflow:hidden; cursor:pointer; box-shadow:0 10px 24px rgba(0,0,0,.15)}
.book-card__cover{width:100%; height:150px; object-fit:cover; display:block}
.book-card__body{padding:10px}
.book-card__title{margin:0 0 4px; font-size:16px}
.book-card__meta{font-size:13px; color:#4d5a54}

/* ====== AUTH NOTES (glass) ====== */
.modal .form .note {
  margin-top: 10px;
  width: 100%;
  padding: 10px 12px;
  border-radius: 12px;
  background: rgba(255,255,255,0.55);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  color: #1c2024;
  box-shadow: 0 6px 18px rgba(31, 97, 64, 0.15);
  border-left: 4px solid transparent;
  line-height: 1.45;
  font-size: 14px;
  transition: transform .18s ease, opacity .18s ease, box-shadow .18s ease;
  transform: translateY(2px);
  opacity: .98;
}
.modal .form .note.ok {
  border-left-color: #2f6e3f; /* xanh lá nhạt */
  box-shadow: 0 8px 22px rgba(47,110,63,.18);
}
.modal .form .note.err {
  border-left-color: #b42318; /* đỏ */
  box-shadow: 0 8px 22px rgba(180,35,24,.18);
  color: #7f1d1d;
}

/* Nhỏ gọn khi text rỗng */
.modal .form .note:empty { display: none; }

/* Bảo đảm note nằm trên nền blur đúng z-index */
.modal[aria-hidden="false"] .modal__panel { z-index: 20; }

/* (phòng hờ) Nút đang active trong tab/season: viền xanh nổi bật */
.tab.is-active,
.tab-line.is-active {
  box-shadow: 0 0 0 2px rgba(47,110,63,.35) inset, 0 6px 16px rgba(47,110,63,.15);
}

/* ==== BẮT ĐẦU: Style chung cho modal/auth ==== */
.modal[aria-hidden="true"] { display:none; }
.modal { position:fixed; inset:0; z-index:80; }
.modal__backdrop{
  position:absolute; inset:0; backdrop-filter: blur(6px);
  background: rgba(0,0,0,.25);
}
.modal__panel{
  position:relative; z-index:1; margin:8vh auto 0; width:min(640px,92vw);
  background: rgba(255,255,255,.86);
  border:1px solid rgba(255,255,255,.55);
  box-shadow: 0 12px 36px rgba(0,0,0,.22);
  border-radius: 18px; padding: 18px 18px 16px;
  -webkit-backdrop-filter: blur(10px); backdrop-filter: blur(10px);
}
.modal__head{ display:flex; align-items:center; justify-content:space-between; gap:10px; }
.modal__title{ margin:0; font-weight:800; color:#21512d; }
.modal__close{ border:0; background:transparent; font-size:18px; cursor:pointer; color:#21512d; }

.tabs-line{ display:flex; gap:8px; margin: 10px 2px 4px; flex-wrap:wrap; }
.tab-line{
  padding:8px 12px; border-radius:999px; border:1px solid rgba(0,0,0,.15);
  background: rgba(255,255,255,.15); font-weight:700; cursor:pointer; color:#173320;
  box-shadow: 0 6px 16px rgba(47,110,63,.15);
}
.tab-line.is-active{
  outline: none;
  box-shadow: 0 0 0 2px rgba(47,110,63,.35), 0 8px 20px rgba(47,110,63,.25);
  background: rgba(255,255,255,.25);
  border-color: rgba(47,110,63,.35);
}

.form{ display:none; }
.form.is-active{ display:block; }
.row{ display:flex; flex-direction:column; gap:6px; margin:10px 2px; }
.input.underline{
  border:0; border-bottom: 2px solid rgba(33,81,45,.25);
  padding: 10px 2px; outline:none; background: transparent;
}
.input.underline:focus{
  border-bottom-color: rgba(47,110,63,.8);
  box-shadow: 0 6px 14px rgba(47,110,63,.14);
}
.btn{ height:42px; padding:0 16px; border-radius:999px; cursor:pointer; font-weight:800; }
.btn.solid{
  border:1px solid rgba(0,0,0,.15); background: rgba(255,255,255,.15); color:#173320;
  box-shadow: 0 6px 16px rgba(47,110,63,.25);
}
.btn.ghost{
  border:1px dashed rgba(33,81,45,.45); background: transparent; color:#21512d;
}
.note{ margin-top:8px; font-weight:600; }
.note.ok{ color:#0f5132; } .note.err{ color:#7f1d1d; }
/* ==== HẾT: Style chung cho modal/auth ==== */
/* ==== FIX modal can giua + z-index + click ==== */
.modal {
  position: fixed;
  inset: 0;
  z-index: 100;                  /* cao hơn hiệu ứng rơi và mọi thứ khác */
  display: flex;                 /* can giữa panel */
  align-items: center;
  justify-content: center;
  padding: 6vh 16px;             /* không dính sát mép */
}

.modal__backdrop{
  position:absolute; inset:0;
  backdrop-filter: blur(6px);
  background: rgba(0,0,0,.25);
  pointer-events: auto;          /* nhận click để đóng ngoài panel */
}

.modal__panel{
  position: relative; z-index: 1;
  width: min(680px, 92vw);
  margin: 0;                     /* KHÔNG margin – để flex căn giữa chuẩn */
  background: rgba(255,255,255,.86);
  border: 1px solid rgba(255,255,255,.55);
  box-shadow: 0 12px 36px rgba(0,0,0,.22);
  border-radius: 18px;
  padding: 18px 18px 16px;
  backdrop-filter: blur(10px);
  pointer-events: auto;          /* panel nhận click */
}

.form .row { width: 100%; }
.input.underline { width: 100%; box-sizing: border-box; }

/* Đảm bảo hiệu ứng rơi KHÔNG che modal */
#frame canvas { pointer-events: none; z-index: 0 !important; }

/* ===== FIX modal stacking & pointer events ===== */

/* modal tổng phải đứng trên tất cả */
#authModal,
#readerModal {
  position: fixed;
  inset: 0;
  z-index: 9999; /* cao hơn hiệu ứng rơi, blur, ... */
}

/* backdrop ở dưới phần thân modal */
#authModal .modal__backdrop,
#readerModal .modal__backdrop {
  position: absolute;
  inset: 0;
  z-index: 1;
  pointer-events: auto; /* backdrop vẫn nhận click để đóng */
}

/* khung nội dung modal phải cao hơn backdrop */
#authModal .modal__panel,
#authModal .modal__content,
#readerModal .modal__panel,
#readerModal .modal__content {
  position: relative;
  z-index: 2;
  pointer-events: auto;
}

/* khi ẩn modal thì bỏ hẳn khỏi flow để tránh che phủ */
#authModal[aria-hidden="true"],
#readerModal[aria-hidden="true"] {
  display: none !important;
}

/* với nút trong form – tránh submit mặc định */
#authModal button,
#readerModal button {
  -webkit-appearance: none;
  appearance: none;
}
/* Reader modal panel (giống .modal__panel để hiển thị nội dung) */
#readerModal {
  position: fixed;
  inset: 0;
  z-index: 9999;
  display: none;
  align-items: center;
  justify-content: center;
  padding: 6vh 16px;
}
#readerModal[aria-hidden="false"] { display: flex; }
#readerModal .modal__backdrop {
  position: absolute; inset: 0; z-index: 1;
  background: rgba(0,0,0,.25);
  backdrop-filter: blur(6px);
}
#readerModal .reader__panel {
  position: relative; z-index: 2;
  width: min(960px, 94vw);
  background: rgba(255,255,255,.86);
  border: 1px solid rgba(255,255,255,.55);
  border-radius: 18px;
  box-shadow: 0 12px 36px rgba(0,0,0,.22);
  padding: 14px 14px 10px;
  backdrop-filter: blur(10px);
  pointer-events: auto;
}
/* === Reader toolbar fixes === */
.reader__toolbar .btn.small {
  min-width: 56px;
  height: 36px;
  padding: 0 10px;
  font-weight: 800;
  color: #173320;          /* chữ đậm, không trắng trên nền nhạt */
  background: rgba(255,255,255,.85);
  border: 1px solid rgba(0,0,0,.15);
}
.reader__toolbar .btn.small.is-active {
  box-shadow: 0 0 0 2px rgba(47,110,63,.35) inset;
}
#readerModal { z-index: 10001; }     /* luôn trên mọi overlay khác */
#authModal   { z-index: 10000; }







