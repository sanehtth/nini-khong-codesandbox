/* =========================================================
   NiNi — Funny  |  styles.css (clean/merged, absolute-center)
   ========================================================= */

/* ---------- THEME VARS ---------- */
:root{
  --bg-url: url("/public/assets/bg/nini_home.webp");
  --text: #ffffff;
  --text-dim:#e6edf6;
  --chip-bg: rgba(255,255,255,.08);
  --chip-border: rgba(255,255,255,.25);
  --glass: rgba(0,0,0,.35);
  --glass-2: rgba(0,0,0,.45);

  /* dương = hạ khung reader xuống */
  --reader-offset-y: 28px;
}

/* ---------- RESET ---------- */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; color:var(--text);
  font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:#0a1014;
}
body::before{
  content:""; position:fixed; inset:0;
  background-image: var(--bg-url);
  background-size:cover; background-position:center;
  filter: blur(8px) saturate(1.2) brightness(.8);
  transform: scale(1.03);
  z-index:-2;
}
body::after{
  content:""; position:fixed; inset:0;
  background: radial-gradient(1200px 600px at 50% -10%, rgba(0,0,0,.35), rgba(0,0,0,.75));
  z-index:-1;
}

/* ---------- HEADER ---------- */
.site-header{
  position:sticky; top:0; z-index:10;
  display:flex; align-items:center; gap:20px;
  padding:12px min(4vw,24px);
  backdrop-filter: blur(8px);
  background: linear-gradient(180deg, rgba(0,0,0,.45), rgba(0,0,0,.05));
}
.brand{display:flex; align-items:center; gap:10px; text-decoration:none; color:inherit}
.brand__logo{height:38px; width:auto}
.brand__slogan{
  font-weight:600; font-size:14px; letter-spacing:.2px;
  background: linear-gradient(90deg, #ffd44d, #7bd86a, #b88752);
  -webkit-background-clip:text; background-clip:text; color:transparent;
}
.tabs{display:flex; gap:8px; margin-left:auto}
.tab{
  appearance:none; border:none; background:transparent; color:var(--text);
  padding:8px 12px; border-radius:999px; cursor:pointer; opacity:.9
}
.tab:hover{opacity:1}
.tab.is-active{text-decoration: underline}
.auth-btn{
  margin-left:12px;
  padding:8px 14px; border-radius:999px; border:1px solid var(--chip-border);
  background:transparent; color:var(--text); cursor:pointer;
}

/* ---------- LAYOUT ---------- */
.viewport{display:grid; place-items:center; padding:16px 16px 32px}
.frame{
  position:relative;
  width:min(1120px, 92vw); aspect-ratio: 16/9;
  border-radius:16px;
  background:#000 center/cover no-repeat;
  box-shadow: 0 22px 60px rgba(0,0,0,.6), inset 0 0 0 1px rgba(255,255,255,.04);
  overflow:hidden;
}

/* mascot */
.nini{
  position:absolute; bottom:12%; left:50%; transform:translateX(-50%);
  width:min(210px, 22vw); height:auto; pointer-events:none; user-select:none;
  filter: drop-shadow(0 12px 20px rgba(0,0,0,.35));
}

/* chips */
.chips{
  position:absolute; bottom:7%; left:50%; transform:translateX(-50%);
  display:flex; gap:10px;
}
.chip{
  background: var(--chip-bg); color:var(--text);
  border:1px solid var(--chip-border); padding:10px 14px; border-radius:999px;
  cursor:pointer; backdrop-filter: blur(6px);
}
.chip:hover{border-color:#fff}
.chip.is-active{text-decoration: underline}

/* content card dưới khung */
.content{
  width:min(1140px, 94vw);
  margin:18px auto 0; padding:16px 20px 20px;
  border-radius:16px; background: rgba(0,0,0,.25);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.04);
}
.content h2{margin:0 0 8px}
.content p{margin:0}

/* ---------- MODAL BASE ---------- */
.modal{position:fixed; inset:0; display:none}
.modal[aria-hidden="false"]{display:block}
.modal__backdrop{position:absolute; inset:0; background:rgba(0,0,0,.55); backdrop-filter: blur(3px)}
.modal__panel{
  /* Auth modal sẽ override width; Reader sẽ override hoàn toàn cách căn giữa */
  position:absolute; inset:0; margin:auto; width:min(560px, 92vw);
  background: var(--glass-2); border:1px solid rgba(255,255,255,.18);
  border-radius:16px; padding:18px; color:var(--text);
  top:50%; transform:translateY(-50%);
}
.modal__close{
  position:absolute; right:10px; top:8px; font-size:20px; background:transparent; color:#fff; border:none; cursor:pointer;
}
.modal__title{display:flex; align-items:center; gap:10px; margin:0 0 10px}
.modal__logo{width:28px; height:28px}

/* auth forms */
.tabs-line{display:flex; gap:12px; margin:6px 0 12px}
.tab-line{background:transparent; color:#fff; border:none; cursor:pointer; padding:8px 0}
.tab-line.is-active{text-decoration: underline}
.form{display:none}
.form.is-active{display:block}
.form label{display:block; font-size:13px; color:var(--text-dim); margin:10px 0 4px}
.form input{
  width:100%; padding:10px 12px; color:#fff; background:transparent; outline:none;
  border:none; border-bottom:1px solid rgba(255,255,255,.4)
}
.form input::placeholder{color:#cfd8e3}
.row{display:flex; gap:10px; margin-top:14px}
.row.gap{align-items:center}
.btn{
  padding:10px 16px; border-radius:999px; border:1px solid var(--chip-border);
  background:transparent; color:#fff; cursor:pointer;
}
.btn:hover{border-color:#fff}
.btn-ghost{background:transparent}
.btn.full{width:100%}
.or{text-align:center; color:#d0d8e6; margin:8px 0 4px}
.note{font-size:12px; color:#cfd8e3; margin-top:8px}

/* ---------- SHELF IN FRAME ---------- */
.shelf-card{
  position:absolute; left:18px; top:18px; z-index:3;
  width:min(520px, 44%); padding:12px;
  border-radius:14px; background: rgba(0,0,0,.35);
  border:1px solid rgba(255,255,255,.14); backdrop-filter: blur(6px);
}
.shelf-card[hidden]{display:none}
.shelf-card h4{margin:0 0 8px; font-size:16px}
.shelf-list{display:grid; grid-template-columns:repeat(2, 1fr); gap:10px}
.book-card{
  display:flex; gap:10px; padding:8px; border-radius:10px;
  background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12);
  cursor:pointer; transition:transform .12s ease, border-color .12s ease;
}
.book-card:hover{transform:translateY(-2px); border-color:rgba(255,255,255,.28)}
.book-card__cover{
  width:64px; height:64px; border-radius:6px; object-fit:cover; flex:0 0 64px;
  background:#111;
}
.book-card__title{margin:2px 0 2px; font-weight:600; font-size:14px}
.book-card__meta{font-size:12px; color:#d9e2ef}

/* =========================================================
   READER 16:9 — CĂN GIỮA TUYỆT ĐỐI (không lệ thuộc caption)
   ========================================================= */

/* Reader modal panel: bỏ kiểu center cũ, dùng absolute center */
#readerModal .modal__panel{
  position: fixed;
  inset: 0;
  background: transparent;
  border: 0;
  padding: 0;
  /* không dùng flex/transform ở đây để tránh lệch */
}

/* Khối được căn giữa thật sự */
.reader-wrap{
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, calc(-50% + var(--reader-offset-y)));
  width: min(92vw, 1120px);
}

/* Tiêu đề nổi, không đẩy khung */
#readerModal .modal__title{
  position: absolute;
  left: 50%;
  transform: translate(-50%, -110%);
  margin: 0;
  padding: 10px 14px;
  max-width: 90vw;
  border-radius: 12px;
  background: rgba(0,0,0,.45);
  border: 1px solid rgba(255,255,255,.18);
  backdrop-filter: blur(6px);
}

/* Khung 16:9 */
.calendar-view.mode-169{
  position: relative;
  width: 100%;
  aspect-ratio: 16 / 9;
  max-height: 72vh;
  margin: 0;                 /* quan trọng: không để margin gây lệch */
  border-radius:16px;
  overflow:hidden;
  box-shadow: 0 16px 50px rgba(0,0,0,.5), inset 0 0 0 1px rgba(255,255,255,.05);
}

/* Ảnh nền phủ khung */
.calendar-bg{
  position:absolute; inset:0;
  background:#000 center/cover no-repeat;
  z-index:1;
  image-rendering: -webkit-optimize-contrast;
  image-rendering: crisp-edges;
}

/* Toolbar góc trên-phải */
.reader-toolbar{
  position:absolute; right:12px; top:12px; display:flex; gap:8px; z-index:3;
}
.pill{
  min-width:38px; height:34px; padding:0 10px; border-radius:999px;
  border:1px solid rgba(255,255,255,.55); background:rgba(0,0,0,.45);
  color:#fff; cursor:pointer; backdrop-filter: blur(6px);
}
.pill.active{ background:rgba(255,255,255,.75); color:#111; }

/* Phụ đề ở đáy ảnh */
.subtitle-bubble{
  position:absolute; left:16px; right:16px; bottom:58px; margin:auto;
  max-width:min(960px, 90%); color:#fff; background:rgba(0,0,0,.45);
  border:1px solid rgba(255,255,255,.18); border-radius:12px; padding:10px 12px;
  line-height:1.6; backdrop-filter:blur(6px); z-index:3; display:none;
}

/* Nút Prev/Next + info ở dưới */
.img-nav{
  position:absolute; left:0; right:0; bottom:10px; display:flex;
  align-items:center; justify-content:center; gap:14px; z-index:3;
}
.pill-nav{
  min-width:38px; height:38px; border-radius:999px; border:1px solid rgba(255,255,255,.55);
  background:rgba(0,0,0,.45); color:#fff; cursor:pointer; backdrop-filter: blur(6px);
}
.page-info{ color:#fff; font-weight:600; text-shadow:0 1px 2px rgba(0,0,0,.6) }

/* Hiệu ứng chuyển trang (tuỳ dùng) */
.flip-out{ animation:flipOut .32s ease forwards }
.flip-in{  animation:flipIn  .32s ease forwards }
@keyframes flipOut{ 0%{transform:rotateX(0);opacity:1} 100%{transform:rotateX(-80deg) translateY(6%) scale(.98); opacity:.4} }
@keyframes flipIn { 0%{transform:rotateX(80deg) translateY(6%) scale(.98); opacity:.4} 100%{transform:rotateX(0); opacity:1} }

/* ---------- RESPONSIVE ---------- */
@media (max-width: 640px){
  .nini{width:150px}
  .shelf-card{width:calc(100% - 36px)}
  :root{ --reader-offset-y: 14px; }
}
@media (max-height: 740px){
  :root{ --reader-offset-y: 16px; }
}
/* ============ Reader: caption nằm TRONG ảnh 16:9 ============ */

/* khối reader căn giữa tuyệt đối, giữ như cũ nhưng hạ xuống chút */
:root{ --reader-offset-y: 34px; } /* tăng số này nếu muốn hạ xuống thêm */

#readerModal .modal__panel{
  position: fixed;
  inset: 0;
  background: transparent;
  border: 0;
  padding: 0;
}

.reader-wrap{
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, calc(-50% + var(--reader-offset-y)));
  width: min(92vw, 1120px);
}

/* khung 16:9 không có margin để khỏi đẩy lệch */
.calendar-view.mode-169{
  position: relative;
  width: 100%;
  aspect-ratio: 16/9;
  max-height: 72vh;
  margin: 0;
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 16px 50px rgba(0,0,0,.5), inset 0 0 0 1px rgba(255,255,255,.05);
}

/* ảnh nền (page image) */
.calendar-bg{
  position: absolute; inset: 0;
  background: #000 center/cover no-repeat;
  z-index: 1;
  image-rendering: -webkit-optimize-contrast;
  image-rendering: crisp-edges;
}

/* ===== caption NẰM TRONG ảnh, bám đáy, căn giữa ngang ===== */
.subtitle-bubble{
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  bottom: clamp(12px, 2.8vh, 22px);      /* đáy ảnh */
  max-width: min(960px, 90%);
  color: #fff;
  background: rgba(0,0,0,.45);
  border: 1px solid rgba(255,255,255,.18);
  border-radius: 12px;
  padding: 10px 12px;
  line-height: 1.65;
  backdrop-filter: blur(6px);
  z-index: 3;
  display: none;                         /* JS sẽ bật */
}

/* nút prev/next & info cũng NẰM TRONG ảnh */
.img-nav{
  position: absolute;
  left: 0; right: 0; bottom: 10px;
  display: flex; align-items: center; justify-content: center;
  gap: 14px; z-index: 3;
}
.pill-nav{
  min-width: 38px; height: 38px; border-radius: 999px;
  border: 1px solid rgba(255,255,255,.55);
  background: rgba(0,0,0,.45); color:#fff; cursor: pointer;
  backdrop-filter: blur(6px);
}
.page-info{
  color: #fff; font-weight: 600; text-shadow: 0 1px 2px rgba(0,0,0,.6);
}

/* toolbar ngôn ngữ/loa trong ảnh (nếu dùng) */
.reader-toolbar{
  position: absolute; right: 12px; top: 12px; display: flex; gap: 8px; z-index: 3;
}
.pill{
  min-width: 38px; height: 34px; padding: 0 10px; border-radius: 999px;
  border: 1px solid rgba(255,255,255,.55);
  background: rgba(0,0,0,.45); color:#fff; cursor: pointer; backdrop-filter: blur(6px);
}
.pill.active{ background: rgba(255,255,255,.75); color:#111; }

/* tiêu đề “NiNi và …” nổi phía trên reader (không đẩy layout) */
#readerModal .modal__title{
  position: absolute;
  left: 50%; transform: translate(-50%, -110%);
  margin: 0; padding: 10px 14px; max-width: 90vw;
  border-radius: 12px; background: rgba(0,0,0,.45);
  border: 1px solid rgba(255,255,255,.18); backdrop-filter: blur(6px);
}

/* phản hồi màn hình thấp */
@media (max-height: 740px){
  :root{ --reader-offset-y: 20px; }
}

