<!doctype html>
<html lang="vi"><head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Xác minh email — NiNi</title>
<link rel="stylesheet" href="/styles.css?v=16"/>
</head><body>
<main class="viewport" style="display:grid;place-items:center;min-height:100vh">
  <section class="modal__panel" style="position:static;max-width:520px">
    <h3 class="modal__title">
      <img src="/public/assets/icons/logonini.webp" class="modal__logo" alt="" />
      Xác minh email
    </h3>
    <p id="msg" class="note">Đang xác minh...</p>
  </section>
</main>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getAuth, applyActionCode } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

  const app = initializeApp({
    apiKey:"AIzaSyBdaMS7aI03wHLhi1Md2QDitJFkA61IYUU",
    authDomain:"nini-8f3d4.firebaseapp.com",
    projectId:"nini-8f3d4"
  });
  const auth = getAuth(app);
  const msg = document.getElementById("msg");

  const sp = new URLSearchParams(location.search);
  const oob = sp.get("oobCode");

  async function run(){
    if(!oob){ msg.textContent="Thiếu oobCode."; msg.className="note err"; return; }
    try{
      await applyActionCode(auth, oob);
      msg.textContent="Xác minh thành công! Đang chuyển về trang chủ...";
      msg.className="note ok";
      setTimeout(()=> location.href="/#home", 1200);
    }catch(e){
      msg.textContent = e?.code || e?.message || "Mã xác minh không hợp lệ/đã hết hạn.";
      msg.className="note err";
    }
  }
  run();
</script>
</body></html>
